"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.errorHandler = exports.init = void 0;
const commander_1 = require("commander");
const pkg = require('../package.json');
function init() {
    const program = new commander_1.Command()
        .version(pkg.version)
        .option('-d, --debug', 'debug mode')
        .on('option:debug', () => {
        process.env.DEBUG = 'true';
    });
    program.action(() => program.help());
    return program;
}
exports.init = init;
function errorHandler(action) {
    return async (...args) => {
        const options = args.pop();
        try {
            await action(...args, options);
        }
        catch (e) {
            if (process.env.DEBUG) {
                console.error(e);
            }
            else {
                console.error(e.message);
            }
        }
    };
}
exports.errorHandler = errorHandler;
